#!/usr/bin/env zsh

help() {
    cat <<EOF
docs - versatile man alias

Usage: docs [-p|-o] <command>

Options:
    -p  Open documentation in Preview.
    -o  Open documentation in browser.
EOF
}

if [ -z "$1" ] || [[ "$1" == "-h" ]] || [[ "$1" == "--help" ]]; then
    help
    exit 0
fi

if ! man "$1" > /dev/null 2>&1; then
    echo "Manual page for '$1' does not exist."
    exit 1
fi

if [[ "$1" == "-p" ]]; then
    echo "Opening page for '${@:2}' in Preview..."
    for page in "${(@f)"$(man -w "${@:2}")"}"; do
        command mandoc -Tpdf "$page" | open -f -a Preview
    done
elif [[ "$1" == "-o" ]]; then
    echo "Opening page for '$2' in browser..."
    open "https://ss64.com/osx/$2.html"
else
    man "$@"
fi